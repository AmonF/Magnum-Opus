<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Magnum Opus</title>
<link href="Opus.css" rel="stylesheet" type="text/css">
	
<!-- fonts	-->
<link href="https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Rubik:ital,wght@0,500;1,500&display=swap" rel="stylesheet">
	
</head>

<body>
<!------------------------------------- Pretty Background ------------------------------------------>
	<div class="bg" id="bg01"></div>
	<div class="bg" id="bg02"></div>
	<div class="black" id="bgBlack"></div>
	<div class="bg">
		<video id="bg1" loop>
  			<source src="background fade.mp4" type="video/mp4">
		</video>		
		<video id="bg2" loop>
  			<source src="gradient fade.mp4" type="video/mp4">
		</video>
	</div>
	
<!------------------------------------------ SCENE 1 ----------------------------------------------->
	
	<div class="Scene1">  <!--each screen is a different page---> 
		<button id="info">i</button>
		<button class="sponsor" id="s1">Sponsor a Raffle</button>
		<div class="bg" id="bg0"></div>
		<div id="titleBox">
			<div id="title">
				<span id="black">Black</span><span id="cash">Cash</span>
				<div id="subtitle">Enter to Win!</div>
			</div>
		</div>
		<div id="startBox"><button class="next" id="start">Start</button></div>
		</div>
	</div>	

<!------------------------------------------ SCENE 2 ----------------------------------------------->
	
	<div class="Scene2">

		<button class="home"><img class="house" src="house.png"></button> <!-- home button	-->
		
		<div class="caption" id="c2">Log in using your Aggie email address!</div>
		
		<iframe name="hidden" style="display: none;"></iframe> <!-- this code is required to connect to the google form -->
		
		<div id="formBox"> <!-- visitor google form -->
			<form id="visitors" action="https://docs.google.com/forms/u/0/d/e/1FAIpQLSd6LrXa2MwBuFyc2Ewa5MK06g2vSOri0qfCLGednWCy0eGgrQ/formResponse" target="hidden">
				<input type="text" name="entry.1100716498" placeholder="example@aggies.ncat.edu" />
			</form>
			
			<div id="enterBox">
				
				<button id="access" type="submit">enter</button>
				
				<video id="bg3" loop>
  					<source src="background fade.mp4" type="video/mp4">
				</video>
				
				<div class="captionB" id="guest"> Just Visiting </div>
				
			</div>
			
		</div>
		
	</div>	
	
<!------------------------------------------ SCENE 3 ----------------------------------------------->
	
	<div class="Scene3">
		<div class="black" id="b3"></div>
		<div class="black" id="b32"></div>
		<div class="screen" id="g3"></div>
		<div class="screen" id="g32"></div>
		
		
		<button class="home"><img class="house" src="house.png"></button> <!-- home button -->
			
		<button id="displayName" disabled> example@aggies.ncat.edu </button>
		
		<div id="carousel">
			<div id="caroContainer">
				<div class="line"></div>

				<div class="raffle" value="1">
					<div class="caption c3">$100</div>
					<div class="prize caption"> prize! </div>
					<div class="captionB t3"> 0/800 </div>
					<div class="captionB t32"> entrants </div>
					<button class="enter" value="120" type="submit">enter</button>
					<!-- value is the duration -->
				</div>

				<div class="line"></div>

				<div class="raffle" value="2">
					<div class="c3 caption">$50</div>
					<div class="prize caption"> prize! </div>
					<div class="captionB t3"> 0/400 </div>
					<div class="captionB t32"> entrants </div>
					<button class="enter" value="60" type="submit">enter</button>
				</div>

				<div class="line"></div>

				<div class="raffle" value="3">
					<div class="caption c3">$25</div>
					<div class="prize caption"> prize! </div>
					<div class="captionB t3"> 0/200 </div>
					<div class="captionB t32"> entrants </div>
					<button class="enter" value="30" type="submit">enter</button>
				</div>

				<div class="line"></div>

				<div class="raffle" value="4">
					<div class="caption c3">$30</div>
					<div class="prize caption"> prize! </div>
					<div class="captionB t3"> 0/240 </div>
					<div class="captionB t32"> entrants </div>
					<button class="enter" value="30" type="submit">enter</button>
				</div>

				<div class="line"></div>

				<div class="raffle" value="5">
					<div class="caption c3">$60</div>
					<div class="prize caption"> prize! </div>
					<div class="captionB t3"> 0/480 </div>
					<div class="captionB t32"> entrants </div>
					<button class="enter" value="30" type="submit">enter</button>
				</div>

				<div class="line"></div>

				<div class="raffle" value="6">
					<div class="caption c3">$10</div>
					<div class="prize caption"> prize! </div>
					<div class="captionB t3"> 0/80 </div>
					<div class="captionB t32"> entrants </div>
					<button class="enter" value="30" type="submit">enter</button>
				</div>
				
				<div class="line"></div>
				
				<div class="raffle" value="1">
					<div class="caption c3">$100</div>
					<div class="prize caption"> prize! </div>
					<div class="captionB t3"> 0/800 </div>
					<div class="captionB t32"> entrants </div>
					<button class="enter" value="120" type="submit">enter</button>
					<!-- value is the duration -->
				</div>

				<div class="line"></div>

				<div class="raffle" value="2">
					<div class="c3 caption">$50</div>
					<div class="prize caption"> prize! </div>
					<div class="captionB t3"> 0/400 </div>
					<div class="captionB t32"> entrants </div>
					<button class="enter" value="60" type="submit">enter</button>
				</div>

				<div class="line"></div>

				<div class="raffle" value="3">
					<div class="caption c3">$25</div>
					<div class="prize caption"> prize! </div>
					<div class="captionB t3"> 0/200 </div>
					<div class="captionB t32"> entrants </div>
					<button class="enter" value="30" type="submit">enter</button>
				</div>

				<div class="line"></div>

				<div class="raffle" value="4">
					<div class="caption c3">$30</div>
					<div class="prize caption"> prize! </div>
					<div class="captionB t3"> 0/240 </div>
					<div class="captionB t32"> entrants </div>
					<button class="enter" value="30" type="submit">enter</button>
				</div>

				<div class="line"></div>

				<div class="raffle" value="5">
					<div class="caption c3">$60</div>
					<div class="prize caption"> prize! </div>
					<div class="captionB t3"> 0/480 </div>
					<div class="captionB t32"> entrants </div>
					<button class="enter" value="30" type="submit">enter</button>
				</div>

				<div class="line"></div>

				<div class="raffle" value="6">
					<div class="caption c3">$10</div>
					<div class="prize caption"> prize! </div>
					<div class="captionB t3"> 0/80 </div>
					<div class="captionB t32"> entrants </div>
					<button class="enter" value="30" type="submit">enter</button>
				</div>

				<div class="line"></div>
				<div class="spacer"></div>

			</div>
		</div>
		
		<button class="sponsor" id="s3">Sponsor a Raffle</button>
		
	</div>
	
<!------------------------------------------ SCENE T ----------------------------------------------->
	
	<div class="SceneT"> <!-- timer overlay	-->
		<div class="caption" id="cT">Please Wait to Enter..</div>
		<div id="clock">0:30</div>
		
		<div class="skipBox">
			<button id="continue" style="visibility:hidden">continue</button>
			<button id="skip">cancel</button>
		</div>
	</div>
	
</body>
		
<!------------------------------------------ SCENE S ----------------------------------------------->
	
	<div class="SceneS">
		<div class="black" id="bS"></div>
		<div class="black" id="bS2"></div>
		<button class="home"><img class="house" src="house.png"></button>
		<div id="sBox">
			<div class="caption cS" id="cS1">Select how many students you would like exposure to</div>
			<div id="countBox">
				<div id="count">100</div>
				<div id="UpDownBox">
					<button id="up">
						<svg height="3.7vw" width="4vw">
							<polygon points="20,0 0,35 40,35" style="fill:grey;"/>
						</svg>
					</button>
					<button id="down">
						<svg height="3.7vw" width="4vw">
							<polygon points="20,35 0,0 40,0" style="fill:grey;"/>
						</svg>
					</button>
				</div>
			</div>
			<div class="caption cS" id="cS2">Select how much time you want to display your message</div>
			<div id="timeBox">
				<button class="time" value="15">15s</button>
				<button class="time" value="30">30s</button>
				<button class="time" value="60">1m</button>
			</div>
			<div class="captionB" id="price">$50.00</div>
			<div class="captionB" id="cS3">¢50/student</div>
			<div class="caption cS" id="cS4">Select which category your business best fits under</div>
			<div id="catBox">
				<button class="cat" id="food" value="1">food</button>
				<button class="cat" id="art" value="2">art</button>
				<button class="cat" id="apparel" value="3">apparel</button>
				<button class="cat" id="other" value="4">other</button>
			</div>
			<div class="caption cS" id="cS5">Upload a background image</div>
			<div class="caption cS" id="cS6">( optional )</div>
			<div class="dragBox" id="drag1" ondragover="dragIn(event)" ondragleave="dragOut(event)">
<!--				<img class="folder" src="folder2.png">-->
				<span class="plus">+</span>
			</div>
			
			<div class="caption cS" id="cS7">Upload a video or audio file</div>
			<div class="caption cS" id="cS8">( optional )</div>
			<div class="dragBox" id="drag2" ondragover="dragIn(event)" ondragleave="dragOut(event)">
<!--				<img class="folder" src="folder2.png">-->
				<span class="plus">+</span>
			</div>
			
			<div id="carouselP">
				<div class="lineP"></div>
				<div class="raffle" id="raffleP">
					<button class="iconP">
						<img class="foodP" src="fork.png">
						<img class="artP" src="brush.png">
						<img class="apparelP" src="shirt.png">
						<span class="otherP">?</span>
					</button>
					<div class="caption cP" id="pPrice">$10</div>
					<div class="prizeP caption"> prize! </div>
					<div class="captionB tP" id="pEntrants"> 0/40 </div>
					<div class="captionB tP2"> entrants </div>
					<button id="preview">Preview</button>
				</div>
				<div class="lineP"></div>
<!--				<div class="spacer"></div>-->
			</div>
				
			<div id="bankBox">
				<div class="infoBox">
					<span class="grey caption">Email</span>
					<input class="sponsorInfo textBox" type="text">
				</div>
				<div class="infoBox">
					<span class="grey caption">Website (optional)</span>
					<input class="sponsorInfo textBox" type="text">
				</div>
				<div class="infoBox">
					<span class="caption grey">Card Number</span>
					<div id="cardInfo">
						<input class="sponsorInfo" type="text" id="cardNum">
						<input class="sponsorInfo" type="text" id="month" placeholder="MM" maxlength="2">
						<span class="caption grey" id="slash">/</span>
						<input class="sponsorInfo" type="text" id="year" placeholder="YY" maxlength="2">
						<input class="sponsorInfo" type="text" id="cvv" placeholder="CVC" maxlength="3">
					</div>
				</div>				
				<div class="infoBox">
					<span class="caption grey">Name on Card</span>
					<input class="sponsorInfo textBox" type="text">
				</div>
				<div class="infoBox">
					<span class="caption grey">ZIP Code</span>
					<input class="sponsorInfo textBox" type="text">
				</div>
			</div>
			
			<button type="submit" id="confirm">Sponsor!</button>
			<span class="captionB" id="disclaimer">By clicking Sponsor you agree to the
			<span class="caption" id="terms"> Terms of Service</span></span>
		</div>
	</div>
	
<!------------------------------------------ SCRIPT ------------------------------------------------>
	<script
  src="https://code.jquery.com/jquery-3.4.1.min.js"
  integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
  crossorigin="anonymous"></script>

  <script src="https://bitstorm.org/jquery/shadow-animation/jquery.animate-shadow-min.js"></script> <!-- shadow animaiton plugin -->
	
<script>
	
/*
=================================================================================================
=====================================  Initial Events  ==========================================
=================================================================================================
*/
	var bg1 = document.getElementById("bg1"); 
	var bg2 = document.getElementById("bg2"); 
	var bg3 = document.getElementById("bg3"); 
	
	window.onload = function(){ // initial fade in at start
		$("#bg0").stop().delay(1000).fadeOut(700);
		$("#subtitle").stop().hide().delay(2000).fadeIn(700);
		$("#titleBox").stop().hide().delay(200).css("visibility","visible").delay(200).fadeIn();
		$(".time[value='30']").css("opacity","1");
	};
	
	// code for the button text animation on the home page
	document.querySelectorAll('#start').forEach(button => button.innerHTML = '<div><span>' + button.textContent.trim().split('').join('</span><span>') + '</span></div>');
	   
	var scene = 1; // start on scene 1
	var time; // declare time variable
	var count = 100;
	var clicked = true;
	var price = count/4.0;
	var raffle;
	var adTime = 30;
	var per = 50;
	var tex
	var category = 4;
/*
=================================================================================================
========================================  Functions  ============================================
=================================================================================================
*/
	
	function next(){ //function to transiton to next scene
		$(".Scene" + scene).stop().fadeOut(300); // current scene fade out
		// next scene fade in
		$(".Scene" + (scene + 1)).stop().hide().delay(400).css("visibility","visible").fadeIn(300);
		scene++;
		
		if(scene == 3){
			$("#bgBlack").stop().delay(400).animate({"height":"98%", "top":"1%"},250).fadeOut(500);
		}
	}	
	
	function GoTo(s){ //function to transiton to next scene
		
		$(".Scene" + scene).stop().fadeOut(300); // current scene fade out
		
		if(scene == 'T'){ // if timer overlay is visible
			$(".enter").prop("disabled",false); //re-enable buttons
			$(".Scene3").delay(1000).css("filter","blur(0px)"); // remove blur
			$("#sBox").css("filter","blur(0px)"); // blur scene S
			$(".home").css("filter","blur(0px)"); // blur home button
		}
		else{$(".Scene" + s).stop().hide().delay(400).css("visibility","visible").fadeIn(300);} // show scene given
		scene = s;
	}
	
	function timer(t){ // timer function (t is in seconds)
		update(t); // run the "update" function
		clockStart(t);
		scene = 'T';
		
		$(".SceneT").hide().stop().delay(200).css("visibility","visible").fadeIn(300); // display timer overlay
		$(".Scene3").css("filter","blur(8px)"); // blur scene 3
		$("#sBox").css("filter","blur(8px)"); // blur scene S
		$(".home").css("filter","blur(8px)"); // blur home button
	}
	
	function home(){ //go home
	
		$(".Scene" + scene).stop().fadeOut(300); // fade out current scene
		$(".Scene1").stop().delay(350).fadeIn(300); // fade in scene 1
		$("#bgBlack").stop().delay(50).fadeIn(100).delay(200).animate({"height":"97%", "top":"1.5%"},250);
		scene = 1;

		if (scene == 'S'){
			$(".Scene1").stop().fadeIn(300); // fade in scene 1
			$(".Scene" + scene).stop().fadeOut(300); // fade out current scene
			scene = 1;
		}
		clicked = true;
	}
	
	function update(t){ // reset the clock
		$("#clock").css("visibility","visible").text(format(t)); // update the text and visibility
		clearInterval(clock); // resets the interval code (look up JS intervals to learn more)
	}
	
	function format(t){ //time format 0:00
		var minutes = (t / 60) | 0;
		var seconds = t % 60;
		var format = minutes + ":" + ((seconds < 10) ? "0" + seconds : seconds);
		
		return format;
	}
	
	function clockStart(t){	// clock countdown function
		
		$("#continue").css("visibility","hidden"); // hide continue button
		$("#skip").show(); // show skip button
		var tf = true; // boolean for flash
		time = t;

		// Update the count down every 1 second
		var clock = setInterval(function() {
			
			if(scene != 'T'){clearInterval(clock);} // only counts when clock is showing
			
		  	$("#clock").text(format(time)); // update clock text
			time--; // count down 1 second
			
			// when the count down is finished
		  	if (time < 0) {
				clearInterval(clock);
				time = t;
				$("#clock").text("0:00");
				
				$("#continue").css("visibility","visible"); // show continue button
				$("#skip").hide(); // hide skip button
				
				
				// timer blink at 0 seconds
				var flash = setInterval(function(){ 
					if(scene != 'T'){clearInterval(flash); $("#clock").css("visibility","visible");}
					tf = !tf; // boolean switch
					$("#clock").css("visibility", (tf ? "visible":"hidden")); // show or hide based on tf
				} ,500); // repeat every 500ms (half second)
		  	}
		}, 1000); // tick every 1000ms (second)
	}
	
	function disable(n){ // disables button of choice
		if(n == "all"){ // disable all the buttons
			$(".enter").prop("disabled",true);
			$(".enter").css({"cursor":"not-allowed", "opacity":"0.75"});
		}
		var button = $(".raffle[value='" + n +"']").children().next(".enter");
		button.prop("disabled",true);
		button.css({"cursor":"not-allowed", "opacity":"0.75"});
		button.text("entered")
	}
	
	function getData(){ // links and converts entrants google form response spreadsheet to json format

        $.ajax({
			url:'https://spreadsheets.google.com/feeds/worksheets/1rPvgSi61YIbUWs2UFRw_qQThfzgEqMBTwj9vVcgoUVY/public/basic?alt=json',
			method:"GET"
		}).done(function(users){
			var userCount = 0;
            for(var x in users){
				userCount++;
                console.log("users[x] ");
                console.log(users[x]);
            }
            console.log("users ");
            console.log(users);
            console.log("count " + userCount);
        })
	}
	
	function dragIn(event){
		event.target.style.background = "rgba(83,200,255,.85)";
		event.target.style.border = "0.4vw dashed #66e0ff";
		$(".plus").css({"background":"transparent","color":"white","border":"none"});
	}	
	
	function dragOut(event){
		event.target.style.background = "rgba(232,232,232,1)";
		event.target.style.border = "0.4vw solid rgb(118 118 118)";
		$(".plus").css({"background":"transparent","color":"rgb(118 118 118)","border":"none"});
	}
	
/*
=================================================================================================
======================================= Event Listeners =========================================
=================================================================================================
*/
	
	$("button").click(function(){
		bg1.play();
		bg2.play();
		bg3.play();
		$("#bg01").stop().fadeOut(50);
		$("#bg02").stop().fadeOut(50);
	});
	
	$("button").click(function(){
		$("#cash").css("animation","none");
	});
	
	$("#skip").click(function(){ //skip button
		if (clicked) {GoTo(3)};
		clicked = !clicked;
	});
	
	$("#continue").click(function(){
		$("#raf").val(raffle);
		$("#entrants").submit(); //submit to the entrants form
		GoTo(3);
		disable(raffle);
	});
	
	$("#s1").click(function(){
		if (clicked) {
			$("#bgBlack").stop().animate({"height":"100%", "top":"0%"},250).delay(400).fadeOut(400);
			GoTo("S");
		} 
  		clicked= !clicked;	
	});
	
	$("#s3").click(function(){
		if (clicked) {
			$("#bgBlack").stop().fadeIn(200).animate({"height":"100%", "top":"0%"},250).delay(400).fadeOut(400);
			GoTo("S");
		} 
  		clicked= !clicked;	
	});

	$(".next").click(function(){ // event listener for any button with the next class
		if (clicked){next();} // run the "next" function
		clicked = !clicked;
	});
	
	$(".home").click(function(){ // event listener for home button / home class
		$(".enter").prop("disabled",false);
		$(".enter").css({"cursor":"pointer", "opacity":"1"});
		home(); // run "home"
	});
	
	$("#guest").click(function(){
		disable("all");
		if (!clicked) {next();} 
  		clicked= !clicked;
	});
	
	$("#up").click(function(){
		count++;
		price = (per == 1) ? count : count*(per/100);
		
		$("#count").text(count);
		$("#price").text("$" + (((price % 1) == 0) ? price + ".00" : (((price % 1) == 0.5) ? price + "0" : price)));
		// if price is a whole number then add .00, if price is .5 the add 0, otherwise leave it alone 	
		$("#pEntrants").text("0/" + count);
		$("#pPrice").text("$" + (((price % 1) == 0) ? Math.floor(price/2) : Math.floor(price/2)));
	});	
	
	$("#down").click(function(){
		if(count == 0){count = 0;} 
		else{count--; price = (per == 1) ? count : count*(per/100);}
		
		$("#count").text(count);
		$("#price").text("$" + (((price % 1) == 0) ? price + ".00" : (((price % 1) == 0.5) ? price + "0" : price)));
		$("#pEntrants").text("0/" + count);
		$("#pPrice").text("$" + (((price % 1) == 0) ? Math.floor(price/2) : Math.floor(price/2)));
	});
	
	$("#access").click(function(){ // scene 2 form button event listener
		if($("#visitors > input").val().includes("@aggies.ncat.edu")){ // validates if the email is an aggie one (but easy to bypass)
			$("#visitors").submit(); // submits the user email to the "visitors" form
			$("#displayName").text($("#visitors > input").val()); // populates the user email into the "entrants" form input in scene 3
			if (!clicked) {next();} 
  			clicked= !clicked;
		}
		else{alert("The email you entered does not include @aggies.ncat.edu");} // error message (needs improvement)
		
	});
	
	$(".enter").click(function(){ // scene 3 enter button
		$(".enter").prop("disabled",true); // disable enter button to prevent double clicking glitch
		timer($(this).val()); // this takes the value of the raffle's enter button
		raffle = $(this).parent().attr("value");
		clicked = true;
	});
	
	$("#preview").click(function(){ // ad preview button
		timer(adTime); // start timer
		clicked = true;
	});
	
	$(".time").click(function(){
		adTime = $(this).val();
		per = (($(this).val()==15) ? 25 : (($(this).val()==30) ? 50 : 1)) // calculates the price per student
		price = (per == 1) ? count : count*(per/100); // calculates the overall price
		$("#price").text("$" + (((price % 1) == 0) ? price + ".00" : (((price % 1) == 0.5) ? price + "0" : price))); // sets price text
		$(".time").not(".time[value='" + adTime + "']").css("opacity","0.6"); // every other time button decrease opacity
		$(this).css("opacity","1"); // clicked time button not opaque
		$("#cS3").text((per == 1) ? "$1/student" : ("¢" + per + "/student")); // per student text update
		$("#pPrice").text("$" + (((price % 1) == 0) ? (price/2) : ((price/2).toFixed(2))));
	});
	
	$(".cat").click(function(){
		category = $(this).val();
		$(".cat").not(".cat[value='" + category + "']").css("opacity","0.4"); // every other category button decrease opacity
		$(this).css("opacity","1"); // clicked category button not opaque
		
		switch (category) {
  			case "1":
				$(".icon").css("background","orange");
				$(".food").css("display","block");
				$(".food").siblings().css("display","none");
    			break;
  			case "2":
    			$(".icon").css("background","red");
				$(".art").css("display","block");
				$(".art").siblings().css("display","none");
				break;
			case "3":
				$(".icon").css("background","limegreen");
				$(".apparel").css("display","block");
				$(".apparel").siblings().css("display","none");
				break;
			case "4":
				$(".icon").css("background","deepskyblue");
				$(".other").css("display","block");
				$(".other").siblings().css("display","none");
		}
	});
	
	$(".dragBox").hover(function(){
		$(this).css("background","rgba(232,232,232,0.75)");
	},  function(){
		$(this).css("background","rgba(232,232,232.55)");
	});


	
</script>
</html>
