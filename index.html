<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Magnum Opus</title>
<link href="Opus.css" rel="stylesheet" type="text/css">
	
<link href="https://fonts.googleapis.com/css?family=Roboto:400,500,700&amp;display=swap" rel="stylesheet" />
	
<link href="https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap" rel="stylesheet">
	
<link href="https://fonts.googleapis.com/css2?family=Rubik:ital,wght@1,500&display=swap" rel="stylesheet">
	
</head>

<body>
	
	
	<div class="Scene1">
		<div id="title">Magnum</div>
		<div class="startBox"><button class="next" id="start">Start</button></div>
	</div>
	
	<div class="Scene2">
		<button class="home" ><img class="house" src="house.png"></button>
		<div class="caption">Please Wait for a ticket..</div>
		<div id="clock">2:00</div>
		
		<div class="skipBox">
			<button class="next" id="continue" style="visibility:hidden">continue</button>
			<button class="next" id="skip">skip</button>
		</div>
	</div>
	
	<div class="Scene3">
		<button class="home"><img class="house" src="house.png"></button>
		
		<div class="caption" id="c3">Enter your Aggie Email address to be Entered into the drawing</div>
		
		<iframe name="hidden" style="display: none;"></iframe>
		
		<div id="formBox">
			<form id="email" action="https://docs.google.com/forms/u/0/d/e/1FAIpQLSd6LrXa2MwBuFyc2Ewa5MK06g2vSOri0qfCLGednWCy0eGgrQ/formResponse" target="hidden">
				<input type="text" name="entry.1100716498" placeholder="example@aggies.ncat.edu" />

			</form>
			<button id="enter" type="submit">enter</button>
		</div>
		<div class="tickets" id="t3"></div>
		
	</div>
	
	<div class="Scene4">
		<button class="home"><img class="house" src="house.png"></button>
		<div class="tickets" id="t4"></div>
		<div>you have been entered!</div>
		<button class="next">Enter Again?</button>
	</div>
	
</body>
	
	<script
  src="https://code.jquery.com/jquery-3.4.1.min.js"
  integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
  crossorigin="anonymous"></script>

  <script src="https://bitstorm.org/jquery/shadow-animation/jquery.animate-shadow-min.js"></script> <!-- shadow animaiton plugin -->
	
<script>
	
	window.onload = function(){
		$(".Scene1").hide().css("visibility","visible").delay(300).fadeIn();
	};
	
	var scene = 1;
	var tickets = 1;
	var time = 120;
	
	function next(){
		
		$(".tickets").text("you have " + tickets + ((tickets == 1)? " ticket":" tickets"));
		$(".Scene" + scene).fadeOut(300);
		
		if(scene == 4){
			update();
			clockStart();
			$(".Scene2").hide().delay(300).fadeIn(300);
			scene = 2;
		}
		
		else{			
			$(".Scene" + (scene + 1)).hide().delay(400).css("visibility","visible").fadeIn(300);
			scene++;
		}
	}
	
	function home(){
	
		$(".Scene1").fadeIn(300);
		$(".Scene" + scene).fadeOut(300);
		scene = 1;
	}
	
	function update(){
		$(".tickets").text("you have " + tickets + ((tickets == 1)? " ticket":" tickets"));
		clearInterval(clock);
		time = 120;
	}
	
	function clockStart(){	
		
		$("#continue").css("visibility","hidden");
		$("#skip").show();
		var tf = true;

		// Update the count down every 1 second
		var clock = setInterval(function() {
			
			if(scene != 2){clearInterval(clock);}
			
			var minutes = (time / 60) | 0;
			var seconds = time % 60;
			var format = minutes + ":" + ((seconds < 10) ? "0" + seconds : seconds);
			
			// Display the result in the element with id="clock"
		  	$("#clock").text(format);
			time--;
			
			// If the count down is finished, write some text
		  	if (time <= 0) {
				clearInterval(clock);
				time = 120;
				$("#clock").text("0:00");
				tickets++;
				
				$("#continue").css("visibility","visible");
				$("#skip").hide();
				
				var flash = setInterval(function(){
					if(scene != 2){clearInterval(flash); $("#clock").css("visibility","visible");}
					tf = !tf;
					$("#clock").css("visibility", (tf ? "visible":"hidden"));
				} ,500);
		  	}
		}, 1000);
	}
	
	
	
	$(".next").click(function(){
		next();
		update();
		$("#clock").css("visibility","visible");
	});
	
	$(".home").click(function(){
		home();
		update();
	});
	
	$("#start").click(function(){
		update();
		if(time == 120){clockStart();}
//		$(this).animate("")
	});
	
	$("#enter").click(function(){
		update();
		$(".tickets").text("you have " + tickets + ((tickets == 1)? " ticket":" tickets"));
//		$(".tickets").text("0");
		if(tickets > 0){
			tickets--;
			console.log(tickets);
			$("#email").submit();
			next();
		}
		else{alert("Not enough Tickets");}
		
	});
	
	
	document.querySelectorAll('#start').forEach(button => button.innerHTML = '<div><span>' + button.textContent.trim().split('').join('</span><span>') + '</span></div>');
	
</script>
</html>
